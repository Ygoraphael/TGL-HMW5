@page "/addstudent"
@using BlazorCRUD.Data

<h1>Create Student</h1>

<EditForm Model="_student" OnValidSubmit="NewStudent">

    <div class="form-group mb-3">
        <label for="Name"> Name </label>
        <InputText @bind-Value="_student.Name" class="form-control" id="Name"/>
    </div>

    <div class="form-group mb-3">
        <label for="Email"> Email </label>
        <InputText @bind-Value="_student.Email" class="form-control" id="Email"/>
    </div>

    <DataAnnotationsValidator/>
    <ValidationSummary />

    <button class="btn btn-success" type="submit">Save</button>
    <button @onclick="@(() => navigationManager.NavigateTo("/Student"))" class="btn btn-secondary" >Cancel</button>




</EditForm>

@code {
    [Inject] AppDbContext appDbContext { get; set; }
    [Inject] NavigationManager navigationManager { get; set; }

    private Student _student = new Student
    {
        Name = "",
        Email = ""
    };

    private async Task NewStudent()
    {
        await appDbContext.Students.AddAsync(_student);
        await appDbContext.SaveChangesAsync();
        navigationManager.NavigateTo("/Student");
    }

}
